import{_ as Q,Q as W,g as Y,c as A,f as V,R as H,h as J,r as u,o as x,a as y,b as o,d as a,w as c,m as K,v as O,F as X,T as f,U as S,t as p,q as Z}from"./index.427f4fa2.js";import{c as B,b as D,a as b,u as G,d as U}from"./vee-validate.esm.d9981145.js";import{S as N}from"./sweetalert2.all.7d484c3e.js";import"./_commonjsHelpers.4e997714.js";const $={name:"uploadDataMain",setup(){const n=W(),s=Y(),E=A(()=>n.getUsers),e=A(()=>n.getUser),_=V(!1),v=V(!1),r=V(!1),m=V([{name:"Gerente",code:1},{name:"Gerente Comercial",code:2},{name:"Administrador",code:3}]),k=B({rol:D().nullable().required("El campo es requerido").label(""),nombreCompleto:b().nullable().required("El campo es requerido").label(""),pass:b().nullable().required("El campo es requerido").label(""),correo:b().email("Email inv\xE1lido").nullable().required("El campo es requerido").label("")}),{errors:d,values:C,handleSubmit:g,handleReset:M}=G({validationSchema:k}),l=B({rol:D().nullable().required("El campo es requerido").label(""),nombreCompleto:b().nullable().required("El campo es requerido").label(""),id:b().nullable(),correo:b().email("Email inv\xE1lido").nullable().required("El campo es requerido").label(""),pass:b().label("").when("isBig",{is:t=>typeof t<"u",then:t=>t.nullable().required("El campo es requerido")})}),{errors:q,values:h,handleSubmit:T,handleReset:R}=G({validationSchema:l});U("nombreCompleto"),U("correo"),U("rol"),U("id"),U("pass");const z=g(t=>{r.value=!0,H(s,t.correo,t.pass).then(i=>{t.uid=i.user.uid,n.saveUser([{correo:t.correo,uid:t.uid,nombreCompleto:t.nombreCompleto,rol:t.rol}]).then(w=>{n.actionGetUsers(),_.value=!1,r.value=!1,M()})}).catch(i=>{i.code,i.message})}),F=T(t=>{r.value=!0;const{id:i}=t;delete t.id,n.actionUpdateUser(i,t).then(w=>{console.log(w,"response"),n.actionGetUsers(),v.value=!1,r.value=!1,R()})}),P=()=>{_.value=!0},I=()=>{_.value=!1},L=(t=null)=>{v.value=!v.value,t&&(h.nombreCompleto=t.nombreCompleto,h.correo=t.correo,h.rol=t.rol,h.id=t.id)},j=({id:t})=>{N.fire({title:"Estas segur@?",text:"No podr\xE1s revertir esta acci\xF3n!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!"}).then(i=>{i.isConfirmed&&(r.value=!0,n.actionDeleteUser(t).then(()=>{r.value=!1,n.actionGetUsers(),N.fire("Eliminado!","El usuario ha sido eliminado.","success")}).catch(w=>{console.log("Error deleting user:",w)}))})};return J(()=>{Promise.all([n.actionGetUsers()]).then(()=>{r.value=!1})}),{rows:E,displayModal:_,errors:d,model:C,errorsUpdate:q,modelUpdate:h,saveUser:z,roles:m,cargando:r,displayModalUpdate:v,openModal:P,closeModal:I,deleteUserAction:j,openModalUpdate:L,updateUser:F,user:e}}},ee={class:"flex flex-col gap-4 p-4"},oe={class:"flex justify-between gap-4 box p-2"},le=o("div",{class:"flex items-center ml-4 gap-2"},[o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"30px",height:"30px",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},[o("path",{fill:"gray",d:"M7.5 6.5C7.5 8.981 9.519 11 12 11s4.5-2.019 4.5-4.5S14.481 2 12 2S7.5 4.019 7.5 6.5zM20 21h1v-1c0-3.859-3.141-7-7-7h-4c-3.86 0-7 3.141-7 7v1h17z"})]),o("span",{class:"font-semibold"},"Usuarios")],-1),se={class:"box p-4"},te=Z(" No hay registros para mostrar "),ae={key:0},re={key:1},ne={key:2},de={class:"flex gap-2"},ie={class:"flex flex-col p-4 gap-2"},ce={class:"flex flex-col"},pe=o("span",null,"Nombre Completo",-1),me={class:"text-xs text-red-500"},ue={class:"flex flex-col"},xe=o("span",null,"Correo",-1),be={class:"text-xs text-red-500"},fe={class:"flex flex-col"},_e=o("span",null,"Contrase\xF1a",-1),ve={class:"text-xs text-red-500"},he={class:"flex flex-col"},Ue=o("span",null,"Correo",-1),Ce={class:"text-xs text-red-500"},ge={class:"flex flex-col p-4 gap-2"},we={class:"flex flex-col"},Ve=o("span",null,"Nombre Completo",-1),ye={class:"text-xs text-red-500"},ke={class:"flex flex-col"},Me=o("span",null,"Correo",-1),qe={class:"text-xs text-red-500"},Se={class:"flex flex-col"},Ee=o("span",null,"Contrase\xF1a",-1),Ae={class:"text-xs text-red-500"},Be={class:"flex flex-col"},De=o("span",null,"Correo",-1),Ge={class:"text-xs text-red-500"};function Ne(n,s,E,e,_,v){const r=u("Button"),m=u("Column"),k=u("DataTable"),d=u("InputText"),C=u("Dropdown"),g=u("Dialog"),M=u("ProgressSpinner");return x(),y(X,null,[o("div",ee,[o("div",oe,[le,a(r,{label:"Crear",onClick:s[0]||(s[0]=l=>e.openModal()),class:"p-button-success"})]),o("div",se,[a(k,{value:e.rows,responsiveLayout:"scroll",class:"text-sm"},{empty:c(()=>[te]),default:c(()=>[a(m,{field:"uid",header:"UID"}),a(m,{field:"nombreCompleto",header:"Nombre Completo"}),a(m,{field:"correo",header:"Correo"}),a(m,{field:"rol",header:"Rol"},{body:c(({data:l})=>[l.rol===1?(x(),y("span",ae,"Gerente")):f("",!0),l.rol===2?(x(),y("span",re,"Gerente Comercial")):f("",!0),l.rol===3?(x(),y("span",ne,"Administrador")):f("",!0)]),_:1}),e.user.rol===1||e.user.rol===2?(x(),S(m,{key:0,header:"Acciones"},{body:c(({data:l})=>[o("div",de,[e.user.rol===1||e.user.rol===2?(x(),S(r,{key:0,icon:"pi pi-pencil",class:"p-button-rounded p-button-warning",onClick:q=>e.openModalUpdate(l)},null,8,["onClick"])):f("",!0),e.user.rol===1?(x(),S(r,{key:1,icon:"pi pi-trash",class:"p-button-rounded p-button-danger",onClick:q=>e.deleteUserAction(l)},null,8,["onClick"])):f("",!0)])]),_:1})):f("",!0)]),_:1},8,["value"])])]),a(g,{header:"Crear Usuario",visible:e.displayModal,"onUpdate:visible":s[7]||(s[7]=l=>e.displayModal=l),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"50vw"},modal:!0},{footer:c(()=>[a(r,{label:"Cancelar",icon:"pi pi-times",onClick:s[5]||(s[5]=l=>e.closeModal()),class:"p-button-text"}),a(r,{label:"Guardar",icon:"pi pi-check",onClick:s[6]||(s[6]=l=>e.saveUser()),autofocus:""})]),default:c(()=>[o("div",ie,[o("div",ce,[pe,a(d,{type:"text",modelValue:e.model.nombreCompleto,"onUpdate:modelValue":s[1]||(s[1]=l=>e.model.nombreCompleto=l)},null,8,["modelValue"]),o("span",me,p(e.errors.nombreCompleto),1)]),o("div",ue,[xe,a(d,{type:"text",modelValue:e.model.correo,"onUpdate:modelValue":s[2]||(s[2]=l=>e.model.correo=l)},null,8,["modelValue"]),o("span",be,p(e.errors.correo),1)]),o("div",fe,[_e,a(d,{type:"password",modelValue:e.model.pass,"onUpdate:modelValue":s[3]||(s[3]=l=>e.model.pass=l)},null,8,["modelValue"]),o("span",ve,p(e.errors.pass),1)]),o("div",he,[Ue,a(C,{modelValue:e.model.rol,"onUpdate:modelValue":s[4]||(s[4]=l=>e.model.rol=l),options:e.roles,optionLabel:"name",optionValue:"code",placeholder:"Seleccione un rol"},null,8,["modelValue","options"]),o("span",Ce,p(e.errors.rol),1)])])]),_:1},8,["visible"]),a(g,{header:"Actualizar Usuario",visible:e.displayModalUpdate,"onUpdate:visible":s[14]||(s[14]=l=>e.displayModalUpdate=l),breakpoints:{"960px":"75vw","640px":"90vw"},style:{width:"50vw"},modal:!0},{footer:c(()=>[a(r,{label:"Cancelar",icon:"pi pi-times",onClick:s[12]||(s[12]=l=>e.openModalUpdate()),class:"p-button-text"}),a(r,{label:"Actualizar",icon:"pi pi-check",onClick:s[13]||(s[13]=l=>e.updateUser()),autofocus:""})]),default:c(()=>[o("div",ge,[o("div",we,[Ve,a(d,{type:"text",modelValue:e.modelUpdate.nombreCompleto,"onUpdate:modelValue":s[8]||(s[8]=l=>e.modelUpdate.nombreCompleto=l)},null,8,["modelValue"]),o("span",ye,p(e.errorsUpdate.nombreCompleto),1)]),o("div",ke,[Me,a(d,{type:"text",modelValue:e.modelUpdate.correo,"onUpdate:modelValue":s[9]||(s[9]=l=>e.modelUpdate.correo=l)},null,8,["modelValue"]),o("span",qe,p(e.errorsUpdate.correo),1)]),o("div",Se,[Ee,a(d,{type:"password",modelValue:e.modelUpdate.pass,"onUpdate:modelValue":s[10]||(s[10]=l=>e.modelUpdate.pass=l)},null,8,["modelValue"]),o("span",Ae,p(e.errorsUpdate.pass),1)]),o("div",Be,[De,a(C,{modelValue:e.modelUpdate.rol,"onUpdate:modelValue":s[11]||(s[11]=l=>e.modelUpdate.rol=l),options:e.roles,optionLabel:"name",optionValue:"code",placeholder:"Seleccione un rol"},null,8,["modelValue","options"]),o("span",Ge,p(e.errorsUpdate.rol),1)])])]),_:1},8,["visible"]),K(a(M,{class:"cargando"},null,512),[[O,e.cargando]])],64)}const Pe=Q($,[["render",Ne]]);export{Pe as default};
